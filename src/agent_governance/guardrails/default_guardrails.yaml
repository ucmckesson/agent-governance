# Strict Agent Guardrails Configuration
# Focus: Security, PII, Harmful Content, Hallucination, and Action Control

name: strict-production-guardrails
version: "2026-02-11"

# --- INPUT GUARDRAILS (Before prompt hits the LLM) ---
input_guardrails:
  - type: prompt_injection
    threshold: 0.8
    action: block
  - type: pii_redaction
    entities: ["EMAIL_ADDRESS", "CREDIT_CARD", "SSN", "PHONE_NUMBER"]
    action: redact
  - type: topic_filter
    disallowed_topics:
      - illegal_acts
      - sexual_content
      - competitor_data
      - PII_extraction
    action: block

# --- OUTPUT GUARDRAILS (After LLM response, before user sees it) ---
output_guardrails:
  - type: grounding_check
    threshold: 0.95
    action: block
  - type: content_safety
    severity: high
    action: block
  - type: pii_redaction
    entities: ["EMAIL_ADDRESS", "CREDIT_CARD", "SSN"]
    action: redact

# --- TOOL/ACTION GUARDRAILS (Before agent executes commands) ---
action_guardrails:
  - type: tool_authorization
    allowed_tools: ["search_internal_kb", "read_read_only_db"]
    disallowed_tools: ["execute_shell", "delete_file", "write_to_prod_db"]
    action: restrict
  - type: approval_gate
    actions: ["email_user", "update_customer_record"]
    action: require_approval

# --- MONITORING & LOGGING ---
logging:
  enabled: true
  log_level: DEBUG

# --- RATE LIMITING ---
rate_limits:
  max_requests_per_minute: 10
  max_tokens_per_minute: 5000
