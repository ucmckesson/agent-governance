$schema: "https://json-schema.org/draft/2020-12/schema"
$type: object
title: GovernanceConfig
required:
  - agent
properties:
  agent:
    type: object
    required: [agent_id, agent_name, agent_type, version, env, gcp_project]
    properties:
      agent_id: { type: string }
      agent_name: { type: string }
      agent_type: { type: string, enum: [adk, agent_builder, vertex_endpoint, custom] }
      version: { type: string }
      env: { type: string, enum: [dev, staging, prod] }
      gcp_project: { type: string }
      region: { type: string }
      service_account: { type: [string, "null"] }
  telemetry:
    type: object
    properties:
      enabled: { type: boolean, default: true }
      log_level: { type: string }
      redaction_keys:
        type: array
        items: { type: string }
      redact_fields:
        type: array
        items: { type: string }
      custom_fields:
        type: object
        additionalProperties: true
      buffer:
        type: object
        properties:
          enabled: { type: boolean, default: false }
          max_size: { type: integer, minimum: 1, default: 1000 }
          flush_interval_seconds: { type: integer, minimum: 1, default: 5 }
      cloud_logging:
        type: object
        properties:
          enabled: { type: boolean, default: false }
          project: { type: string }
          log_name: { type: string }
          labels:
            type: object
            additionalProperties: true
          also_stdout: { type: boolean, default: true }
      tracing:
        type: object
        properties:
          enabled: { type: boolean, default: false }
          sample_rate: { type: number, minimum: 0, maximum: 1 }
          dev_console: { type: boolean, default: false }
          session_tracking:
            type: object
            properties:
              enabled: { type: boolean, default: true }
              session_attribute: { type: string, default: governance.session_id }
              user_attribute: { type: string, default: governance.user_id }
      cost_tracking:
        type: object
        properties:
          enabled: { type: boolean, default: false }
          pricing:
            type: object
            additionalProperties:
              type: object
              properties:
                input: { type: number }
                output: { type: number }
          alert_threshold_usd: { type: number, minimum: 0 }
      prompt_tracking:
        type: object
        properties:
          enabled: { type: boolean, default: false }
  guardrails:
    type: object
    properties:
      profile: { type: string, enum: [strict, balanced, permissive, custom], default: strict }
      policy_file: { type: string }
      policy_path: { type: string }
      model_schema_file: { type: string }
      name: { type: string }
      version: { type: string }
      input_guardrails:
        type: array
        items: { type: object }
      output_guardrails:
        type: array
        items: { type: object }
      action_guardrails:
        type: array
        items: { type: object }
      rate_limits:
        type: object
      logging:
        type: object
      tool_allowlist:
        type: array
        items: { type: string }
      tool_denylist:
        type: array
        items: { type: string }
      max_calls_per_minute:
        type: integer
        minimum: 1
      content_blocklist:
        type: array
        items: { type: string }
      tools:
        type: object
      input_validation:
        type: object
      output_validation:
        type: object
      rate_limiting:
        type: object
      content_safety:
        type: object
  dlp:
    type: object
    properties:
      enabled: { type: boolean, default: true }
      action: { type: string, enum: [block, redact, log] }
      info_types:
        type: array
        items: { type: string }
  registry:
    type: object
    properties:
      base_url: { type: string }
      timeout_s: { type: number, minimum: 0 }
      bq_project: { type: string }
      bq_dataset: { type: string }
      bq_table: { type: string }
      registration_schema:
        type: array
        items:
          type: object
          properties:
            name: { type: string }
            type: { type: string }
            mode: { type: string }
  eval:
    type: object
    properties:
      enabled: { type: boolean, default: true }
      thresholds:
        type: object
  compliance:
    type: object
    properties:
      enabled: { type: boolean, default: true }
  labels:
    type: object
    properties:
      required:
        type: array
        items: { type: string }
  golden_data:
    type: object
    properties:
      source: { type: string }
